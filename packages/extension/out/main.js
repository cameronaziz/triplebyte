var g=Object.create;var p=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var b=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty;var T=(t,e)=>{for(var s in e)p(t,s,{get:e[s],enumerable:!0})},h=(t,e,s,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of k(e))!x.call(t,n)&&n!==s&&p(t,n,{get:()=>e[n],enumerable:!(r=y(e,n))||r.enumerable});return t};var C=(t,e,s)=>(s=t!=null?g(b(t)):{},h(e||!t||!t.__esModule?p(s,"default",{value:t,enumerable:!0}):s,t)),U=t=>h(p({},"__esModule",{value:!0}),t);var o=(t,e,s)=>new Promise((r,n)=>{var i=c=>{try{l(s.next(c))}catch(d){n(d)}},m=c=>{try{l(s.throw(c))}catch(d){n(d)}},l=c=>c.done?r(c.value):Promise.resolve(c.value).then(i,m);l((s=s.apply(t,e)).next())});var D={};T(D,{activate:()=>W,deactivate:()=>v});module.exports=U(D);var f=C(require("path")),a=require("vscode"),S=()=>{let t=a.workspace.workspaceFolders;return t?t.map(e=>e.uri):[]},P=t=>o(void 0,null,function*(){let s=(yield a.workspace.fs.readDirectory(t)).filter(([r])=>!r.startsWith(".")&&!r.startsWith("node_modules")).map(([r,n])=>a.Uri.file(f.default.join(t.fsPath,r)));return w(s)}),w=t=>o(void 0,null,function*(){let e=[];for(let s=0;s<t.length;s++){let r=t[s];switch((yield a.workspace.fs.stat(r)).type){case a.FileType.Directory:{let i=yield P(r);e.push(...i)}case a.FileType.File:r.path.endsWith("package.json")&&e.push(r)}}return e}),j=(t,e)=>o(void 0,null,function*(){let s=t.map(i=>o(void 0,null,function*(){let m=yield a.workspace.fs.readFile(i),l=JSON.parse(m.toString());if(l.bin)return e.sendText(`cd ${i.fsPath.split("/").slice(0,-1).join("/")}`),Object.keys(l.bin)})),n=(yield Promise.all(s)).filter(i=>!!i).reduce((i,m)=>i.concat(m),[]);return console.log(n),n}),F=()=>o(void 0,null,function*(){let t=S();if(t.length<1){a.window.showErrorMessage("No workspace found");return}let e=a.window.createTerminal({name:"Tetris",shellPath:"bash",location:2}),s=yield w(t);yield j(s,e),e.show(),e.sendText("tb")}),u=()=>o(void 0,null,function*(){a.commands.executeCommand("workbench.action.terminal.focus"),a.commands.executeCommand("workbench.action.terminal.toggleTerminal"),a.commands.executeCommand("notifications.clearAll"),a.window.showInformationMessage("Starting Tetris in integrated terminal.");let{activeTerminal:t}=a.window;t&&t.hide(),yield F()}),W=t=>o(void 0,null,function*(){a.commands.registerCommand("triplebyte.kill",()=>{t.workspaceState.update("hasStarted",!1)}),a.commands.registerCommand("triplebyte.auto",()=>{t.workspaceState.update("hasStarted",!0)}),a.commands.registerCommand("triplebyte.launch",u),yield u()}),v=()=>{};0&&(module.exports={activate,deactivate});
