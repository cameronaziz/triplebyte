var g=Object.create;var d=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var S=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty;var T=(t,e)=>{for(var s in e)d(t,s,{get:e[s],enumerable:!0})},h=(t,e,s,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of k(e))!b.call(t,n)&&n!==s&&d(t,n,{get:()=>e[n],enumerable:!(r=y(e,n))||r.enumerable});return t};var U=(t,e,s)=>(s=t!=null?g(S(t)):{},h(e||!t||!t.__esModule?d(s,"default",{value:t,enumerable:!0}):s,t)),x=t=>h(d({},"__esModule",{value:!0}),t);var o=(t,e,s)=>new Promise((r,n)=>{var i=c=>{try{l(s.next(c))}catch(m){n(m)}},p=c=>{try{l(s.throw(c))}catch(m){n(m)}},l=c=>c.done?r(c.value):Promise.resolve(c.value).then(i,p);l((s=s.apply(t,e)).next())});var D={};T(D,{activate:()=>W,deactivate:()=>v});module.exports=x(D);var w=U(require("path")),a=require("vscode"),P=()=>{let t=a.workspace.workspaceFolders;return t?t.map(e=>e.uri):[]},j=t=>o(void 0,null,function*(){let s=(yield a.workspace.fs.readDirectory(t)).filter(([r])=>!r.startsWith(".")&&!r.startsWith("node_modules")).map(([r,n])=>a.Uri.file(w.default.join(t.fsPath,r)));return u(s)}),u=t=>o(void 0,null,function*(){let e=[];for(let s=0;s<t.length;s++){let r=t[s];switch((yield a.workspace.fs.stat(r)).type){case a.FileType.Directory:{let i=yield j(r);e.push(...i)}case a.FileType.File:r.path.endsWith("package.json")&&e.push(r)}}return e}),C=(t,e)=>o(void 0,null,function*(){let s=t.map(i=>o(void 0,null,function*(){let p=yield a.workspace.fs.readFile(i),l=JSON.parse(p.toString());if(l.bin)return e.sendText(`cd ${i.fsPath.split("/").slice(0,-1).join("/")}`),Object.keys(l.bin)})),n=(yield Promise.all(s)).filter(i=>!!i).reduce((i,p)=>i.concat(p),[]);return console.log(n),n}),F=()=>o(void 0,null,function*(){let t=P();if(t.length<1){a.window.showErrorMessage("No workspace found");return}let e=a.window.createTerminal({name:"Tetris",shellPath:"bash",location:2}),s=yield u(t);yield C(s,e),e.show(),e.sendText("tb")}),f=()=>o(void 0,null,function*(){a.window.showInformationMessage("Starting Tetris in integrated terminal.");let{activeTerminal:t}=a.window;t&&t.hide(),yield F()}),W=t=>o(void 0,null,function*(){t.workspaceState.get("hasStarted")&&(yield f()),a.commands.registerCommand("triplebyte.kill",()=>{t.workspaceState.update("hasStarted",!1)}),a.commands.registerCommand("triplebyte.auto",()=>{t.workspaceState.update("hasStarted",!0)}),a.commands.registerCommand("triplebyte.launch",f)}),v=()=>{};0&&(module.exports={activate,deactivate});
